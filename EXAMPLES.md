# Примеры использования масок %

## Базовые примеры

### 1. Однозначные числа (%)
```sql
SELECT * FROM Users WHERE UserId = %
```
**Результат при выполнении:**
- Запрос 0: `SELECT * FROM Users WHERE UserId = 0`
- Запрос 1: `SELECT * FROM Users WHERE UserId = 1`
- Запрос 9: `SELECT * FROM Users WHERE UserId = 9`
- Запрос 10: `SELECT * FROM Users WHERE UserId = 0` (цикл)

### 2. Двузначные числа (%%)
```sql
SELECT * FROM Accounts WHERE AccountId = %%
```
**Результат при выполнении:**
- Запрос 0: `SELECT * FROM Accounts WHERE AccountId = 00`
- Запрос 7: `SELECT * FROM Accounts WHERE AccountId = 07`
- Запрос 42: `SELECT * FROM Accounts WHERE AccountId = 42`
- Запрос 99: `SELECT * FROM Accounts WHERE AccountId = 99`
- Запрос 100: `SELECT * FROM Accounts WHERE AccountId = 00` (цикл)

### 3. Трехзначные числа (%%%)
```sql
SELECT * FROM Orders WHERE OrderNumber = '%%%'
```
**Результат при выполнении:**
- Запрос 0: `WHERE OrderNumber = '000'`
- Запрос 123: `WHERE OrderNumber = '123'`
- Запрос 999: `WHERE OrderNumber = '999'`
- Запрос 1000: `WHERE OrderNumber = '000'` (цикл)

## Продвинутые примеры

### 4. Составные идентификаторы
```sql
SELECT * FROM MeterTable WHERE MeterId = 'П00489%%6'
```
**Результат:**
- Запрос 0: `WHERE MeterId = 'П004890006'`
- Запрос 15: `WHERE MeterId = 'П004891506'`
- Запрос 99: `WHERE MeterId = 'П004899906'`

### 5. Несколько масок
```sql
SELECT * FROM Relations WHERE ParentId = %% AND ChildId = %%%
```
**Результат:**
- Запрос 0: `WHERE ParentId = 00 AND ChildId = 000`
- Запрос 42: `WHERE ParentId = 42 AND ChildId = 042`
- Запрос 1234: `WHERE ParentId = 34 AND ChildId = 234`

**Объяснение:** Каждая маска использует свой модуль от счетчика:
- `%%` использует `счетчик % 100`
- `%%%` использует `счетчик % 1000`

### 6. Вложенные маски в строках
```sql
SELECT * FROM Devices
WHERE SerialNumber = 'DEV-%%-%%-%%%%'
```
**Результат:**
- Запрос 0: `WHERE SerialNumber = 'DEV-00-00-0000'`
- Запрос 123: `WHERE SerialNumber = 'DEV-23-23-0123'`
- Запрос 5678: `WHERE SerialNumber = 'DEV-78-78-5678'`

### 7. Диапазоны с разной длиной
```sql
-- Для небольшого набора данных (10 записей)
SELECT * FROM TestTable1 WHERE Id = %

-- Для среднего набора (100 записей)
SELECT * FROM TestTable2 WHERE Id = %%

-- Для большого набора (10000 записей)
SELECT * FROM TestTable3 WHERE Id = %%%%
```

## Практические сценарии

### Сценарий 1: Тестирование личных кабинетов
**Задача:** Имитировать 100 пользователей, обращающихся к своим данным

```sql
SELECT *
FROM UserAccounts
WHERE UserId = %%
  AND DataAreaId = '0c10'
```

**Настройки:**
- Потоков: 50
- Время: 300 сек
- Каждый поток будет циклически проходить через ID от 00 до 99

### Сценарий 2: Тестирование счетчиков
**Задача:** Проверить производительность запросов к счетчикам с составными ключами

```sql
SELECT TOP 1 *
FROM HCSMETERTABLE
WHERE METERID = 'П00489%%6'
  AND DATAAREAID = '0c10'
ORDER BY RECID DESC
```

**Настройки:**
- Потоков: 70
- Время: 180 сек
- Имитация запросов к 100 различным счетчикам

### Сценарий 3: Холостая нагрузка (без маски)
**Задача:** Проверить кэширование и производительность на "горячей" записи

```sql
SELECT *
FROM SystemConfig
WHERE ConfigId = 1
```

**Настройки:**
- Потоков: 100
- Время: 60 сек
- Все запросы идут к одной и той же записи

### Сценарий 4: Комбинированная нагрузка
**Задача:** Тестирование JOIN-запросов с разными данными

```sql
SELECT a.*, b.*
FROM Accounts a
INNER JOIN Balances b ON a.AccountId = b.AccountId
WHERE a.AccountId = %%
  AND b.BalanceDate >= '2024-01-01'
```

**Настройки:**
- Потоков: 50
- Время: 600 сек
- Тестирование производительности JOIN на 100 различных счетах

## Таблица замен

| Счетчик запроса | `%` | `%%` | `%%%` | `%%%%` |
|-----------------|-----|------|-------|--------|
| 0               | 0   | 00   | 000   | 0000   |
| 5               | 5   | 05   | 005   | 0005   |
| 12              | 2   | 12   | 012   | 0012   |
| 99              | 9   | 99   | 099   | 0099   |
| 100             | 0   | 00   | 100   | 0100   |
| 456             | 6   | 56   | 456   | 0456   |
| 999             | 9   | 99   | 999   | 0999   |
| 1000            | 0   | 00   | 000   | 1000   |
| 9999            | 9   | 99   | 999   | 9999   |
| 10000           | 0   | 00   | 000   | 0000   |

## Советы по выбору количества разрядов

| Разрядов | Диапазон | Когда использовать |
|----------|----------|-------------------|
| `%`      | 0-9      | Быстрое тестирование на малых данных |
| `%%`     | 0-99     | Имитация 100 пользователей/счетов |
| `%%%`    | 0-999    | Средние наборы данных |
| `%%%%`   | 0-9999   | Большие наборы данных |
| `%%%%%+` | 10000+   | Очень большие наборы данных |

## Рекомендации

1. **Начинайте с малого**: Используйте `%` или `%%` для первых тестов
2. **Проверяйте данные**: Убедитесь, что в БД есть записи для всего диапазона
3. **Следите за памятью**: Большие диапазоны (`%%%%+`) могут создать много уникальных запросов
4. **Анализируйте результаты**: CSV-файл покажет, какие ID вызывают проблемы с производительностью
