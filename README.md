1. Обрати внимание на комментарии и на структуру. 
2. Приблизительно так выглядит структура WPF приложения, да много, но на расстоянии от такого только +.
3. Обрати внимание на async Task.Run(), как по мне запускать это в CPU bound операцию перебор, но код и так рабочий, я не стал это менять. 
4. Если интересно, то протестируй прогу у себя, я не тестировал (видел .bat, но у меня места не так много на ноутбуке). 

В конце скажу, что в моём решение тоже можно много что поменять и исправить, во многом исправлял код Claude, особенно комментарии делал он).

P.S.: У тебя какая-то странная вложенность в проекте, только на момент отрпавки заметил её. Всё что изменял + коментарии находятся в самом прокте.
